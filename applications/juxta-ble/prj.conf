# Basic Bluetooth configuration - using observer architecture
CONFIG_BT=y
CONFIG_BT_OBSERVER=y
CONFIG_BT_PERIPHERAL=y
CONFIG_BT_DEVICE_NAME="JX_CONNECT"
CONFIG_BT_DEVICE_NAME_DYNAMIC=n
CONFIG_BT_MAX_CONN=1

# Enable maximum BLE GATT MTU (247 bytes) for efficient file transfer.
# Actual ATT_MTU is negotiated at runtime by the peer (e.g., mobile app).
CONFIG_BT_L2CAP_TX_MTU=247
CONFIG_BT_BUF_ACL_RX_SIZE=251
CONFIG_BT_BUF_ACL_TX_SIZE=251

# Additional BLE stack configuration for stability
CONFIG_BT_CTLR=y
CONFIG_BT_CTLR_ADV_EXT=n
CONFIG_BT_CTLR_SCAN_REQ_NOTIFY=n
CONFIG_BT_CTLR_SCAN_REQ_RSSI=n
CONFIG_BT_CTLR_ADV_INDICATION=n

# Enable maximum BLE transmit power (+4 dBm) for extended range
CONFIG_BT_CTLR_TX_PWR_PLUS_4=y
CONFIG_BT_CTLR_TX_PWR_0=y
CONFIG_BT_CTLR_TX_PWR_PLUS_4=y

# Counter API for nRF52 - DISABLED due to BLE conflict
# CONFIG_COUNTER=y
# CONFIG_NRFX_RTC0=y

# Random number generation
CONFIG_ENTROPY_GENERATOR=y

# RTT Configuration for debugging
CONFIG_USE_SEGGER_RTT=y
CONFIG_RTT_CONSOLE=y
CONFIG_SEGGER_RTT_BUFFER_SIZE_UP=8192
CONFIG_SEGGER_RTT_BUFFER_SIZE_DOWN=32

# Memory settings (increased for stability)
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=2048
CONFIG_MAIN_STACK_SIZE=2048
CONFIG_ISR_STACK_SIZE=2048
CONFIG_BT_RX_STACK_SIZE=2048
CONFIG_BT_HCI_TX_STACK_SIZE=1536

# Minimal Bluetooth features
CONFIG_BT_SMP=n
CONFIG_BT_SIGNING=n
CONFIG_BT_ATT_PREPARE_COUNT=0
CONFIG_BT_PRIVACY=n
CONFIG_BT_SETTINGS=n
CONFIG_BT_BUF_EVT_RX_COUNT=2
CONFIG_BT_BUF_EVT_DISCARDABLE_COUNT=2

# Basic logging
CONFIG_LOG=y
CONFIG_LOG_DEFAULT_LEVEL=3
CONFIG_CONSOLE=y
CONFIG_LOG_BACKEND_RTT=y

# Enable drivers needed by vitals library and future FRAM integration
CONFIG_SPI=y
CONFIG_SPI_NRFX=y
CONFIG_ADC=y

# LIS2DH12 Accelerometer support - using custom driver
# CONFIG_SENSOR=y  # Disabled - using custom LIS2DH12 driver
# CONFIG_LIS2DH=y  # Disabled - using custom LIS2DH12 driver
# CONFIG_SPI_LOG_LEVEL_DBG=y
# CONFIG_SENSOR_LOG_LEVEL_DBG=y

# JUXTA Libraries
CONFIG_JUXTA_VITALS_NRF52=y
CONFIG_JUXTA_FRAM=y
CONFIG_JUXTA_FRAMFS=y

# Disable unused drivers
CONFIG_I2C=n

# Compiler optimizations
CONFIG_SIZE_OPTIMIZATIONS=y
CONFIG_COMPILER_OPT="-Os"

# Reduce kernel features
# CONFIG_MINIMAL_LIBC=y 
CONFIG_NEWLIB_LIBC=y
CONFIG_NEWLIB_LIBC_FLOAT_PRINTF=y
CONFIG_NEWLIB_LIBC_FLOAT_SCANF=y 

# Enable better fault context and debugging
CONFIG_DEBUG_THREAD_INFO=y
CONFIG_ASSERT=y 

CONFIG_THREAD_STACK_INFO=y
CONFIG_HW_STACK_PROTECTION=y

# Watchdog timer for system reliability
CONFIG_WATCHDOG=y
# Driver will be selected automatically for nRF; keep this if needed in this NCS version
CONFIG_WDT_NRFX=y

# SMP/MCUmgr over BLE (no MCUboot yet) per SMP.md
CONFIG_SETTINGS=y
CONFIG_BT_SETTINGS=y

CONFIG_MCUMGR=y
CONFIG_MCUMGR_TRANSPORT_BT=y
CONFIG_MCUMGR_GRP_IMG=y
CONFIG_MCUMGR_GRP_OS=y
CONFIG_IMG_MANAGER=y
CONFIG_STREAM_FLASH=y
CONFIG_ZCBOR=y
CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_PARTITION_MANAGER_ENABLED=y

# Enable MCUboot bootloader with Partition Manager (per SMP.md)
CONFIG_BOOTLOADER_MCUBOOT=y

# Pull in Nordic sample DFU defaults to resolve upload area and related settings
CONFIG_NCS_SAMPLE_MCUMGR_BT_OTA_DFU=y