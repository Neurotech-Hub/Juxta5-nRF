# Copyright (c) 2024 NeurotechHub
# SPDX-License-Identifier: Apache-2.0
#
# JUXTA BLE Application Configuration

# Enable Bluetooth Low Energy
CONFIG_BT=y
CONFIG_BT_PERIPHERAL=y
CONFIG_BT_DEVICE_NAME="JUXTA-BLE"

# BLE advertising and GATT (minimal config for nRF52805)
CONFIG_BT_GATT_DYNAMIC_DB=n
CONFIG_BT_GATT_SERVICE_CHANGED=n
CONFIG_BT_ATT_PREPARE_COUNT=1
CONFIG_BT_BUF_ACL_RX_SIZE=27
CONFIG_BT_BUF_ACL_TX_SIZE=27
CONFIG_BT_L2CAP_TX_MTU=23

# Enable GPIO for LED control
CONFIG_GPIO=y

# Minimal logging for nRF52805 (reduce RAM usage)
CONFIG_LOG=y
CONFIG_LOG_DEFAULT_LEVEL=2
CONFIG_BT_LOG_LEVEL_WRN=y

# Enable RTT for logging (since no UART available)
CONFIG_USE_SEGGER_RTT=y
CONFIG_RTT_CONSOLE=y
CONFIG_CONSOLE=y
CONFIG_SEGGER_RTT_MODE_NO_BLOCK_SKIP=y
# Disable UART console (since no UART available)
CONFIG_UART_CONSOLE=n

# Reduced system settings for nRF52805 (48KB RAM total)
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=1024
CONFIG_MAIN_STACK_SIZE=1024

# Reduced Bluetooth settings for nRF52805
CONFIG_BT_RX_STACK_SIZE=1024
CONFIG_BT_HCI_TX_STACK_SIZE=512

# Enable necessary subsystems
CONFIG_ENTROPY_GENERATOR=y

# Disable SPI and Flash drivers (not needed for BLE-only app)
CONFIG_SPI=n
CONFIG_FLASH=n
CONFIG_FLASH_PAGE_LAYOUT=n
CONFIG_SPI_NOR=n

# Additional memory optimizations for nRF52805
# Note: BT_CTLR_* configs require BT_LL_SW_SPLIT which may not be available
# CONFIG_BT_CTLR_RX_BUFFERS=1
# CONFIG_BT_CTLR_TX_BUFFERS=2
CONFIG_BT_BUF_EVT_RX_COUNT=2
CONFIG_BT_BUF_EVT_DISCARDABLE_COUNT=1
CONFIG_BT_BUF_CMD_TX_COUNT=2
CONFIG_BT_CONN_TX_MAX=3
CONFIG_HEAP_MEM_POOL_SIZE=512 